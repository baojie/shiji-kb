# 《史记》知识库 - 数字人文研究项目

> 基于计算语言学、数字人文与数据科学的《史记》综合研究

[![在线访问](https://img.shields.io/badge/在线访问-GitHub%20Pages-blue)](https://baojie.github.io/shiji-kb)
[![数据来源](https://img.shields.io/badge/数据来源-ctext.org-green)](https://ctext.org/shiji/zh)
[![许可证](https://img.shields.io/badge/许可证-CC%20BY--NC--SA%204.0-orange)](LICENSE)

---

## 项目简介

本项目旨在对中国古典史学巨著《史记》进行全面的数字化、结构化和智能化处理，运用现代数字人文方法，构建完整的史记知识体系。

**核心目标**：
- 📚 **文本标注**：对130篇《史记》进行精细化语义标注
- 🏷️ **实体识别**：提取并分类11类历史实体（人名、地名、官职等）
- 🕸️ **知识图谱**：构建史记人物关系与事件网络
- 📊 **数据分析**：运用统计、网络、时空等方法深度挖掘
- 🎨 **可视化**：交互式呈现历史数据与分析结果
- 🤖 **智能应用**：开发智能问答、知识推理等应用

---

## 项目进展

### 当前状态（2026-02-06）

| 任务 | 进度 | 说明 |
|------|------|------|
| **文本标注** | 52/130 (40%) | 已完成本纪12篇、表10篇、书2篇、列传20篇、世家2篇 |
| **实体词表** | ✅ 完成 | 提取5,282个词条，24,249次标注 |
| **分析计划** | ✅ 完成 | 制定10大分析方向的详细方案 |
| **研究方法** | ✅ 完成 | 建立完整的数字人文研究方法体系 |

### 最新成果

#### 1. 实体分类词表（vocabularies/）

从52个已标注章节中提取的完整词表：

| 类别 | 词条数 | 典型示例 |
|------|--------|----------|
| 👤 人名 | 1,820 | 孔子(145次)、项羽(133次)、项王(123次) |
| 🗺️ 地名 | 954 | 咸阳、邯郸、长安 |
| 🎖️ 官职 | 850 | 丞相、太尉、将军 |
| 📅 时间 | 390 | 元年、正月、春秋 |
| 🏛️ 朝代 | 180 | 秦、汉、周 |
| 📜 制度 | 238 | 郡县制、封禅、正朔 |
| 👥 族群 | 61 | 匈奴、夷狄、三苗 |
| 🏺 器物 | 499 | 鼎、玉璧、印绶 |
| ⭐ 天文 | 118 | 彗星、二十八宿、朔旦 |
| 🐉 神话 | 68 | 黄帝、女娲、禹 |
| 🌿 动植物 | 104 | 龙、凤、桑 |

**详情参见**：[kg/vocabularies/README.md](kg/vocabularies/README.md)

#### 2. 研究方法体系

建立了完整的数字人文研究方法框架：

- 📖 [研究方法总则](doc/研究方法总则.md)：综合方法论
- 📋 [高级分析计划](doc/史记高级分析计划.md)：10大分析方向
- 📊 [统计分析报告](doc/史记统计分析.md)：全书统计数据

#### 3. 分析工具

- ✅ `build_vocabularies.py`：自动词表生成工具
- ✅ `batch_process_chapters.py`：批量标注处理框架

---

## 目录结构

```
shiji-kb/
├── README.md                      # 项目说明
├── TODO.md                        # 任务清单
│
├── docs/                          # 网站与原始文本
│   ├── index.html                # GitHub Pages首页
│   ├── chapters/                 # HTML格式章节
│   └── original_text/            # 130篇原始文本
│
├── chapter_md/                    # 标注后的Markdown文件
│   ├── 001_五帝本纪.tagged.md   # 已标注
│   ├── 002_夏本纪.tagged.md
│   └── ...                       # 99/130已完成
│
├── kg/                           # 知识图谱数据
│   ├── README.md                 # 知识图谱说明
│   ├── vocabularies/             # 实体分类词表（11类）
│   ├── relations/                # 人物关系网络
│   ├── genealogy/                # 帝王家谱
│   ├── kg_build_vocabularies.py      # 词表生成脚本
│   ├── kg_extract_all_relations.py   # 关系提取脚本
│   ├── kg_extract_family_relations.py
│   ├── kg_extract_imperial_genealogy.py
│   └── kg_extract_flora_fauna.py
│
├── doc/                          # 技术文档
│   ├── 研究方法总则.md            # 研究方法体系
│   ├── 史记高级分析计划.md        # 高级分析方案
│   ├── 史记统计分析.md            # 统计数据报告
│   ├── ENTITY_TAGGING_SCHEME.md  # 实体标注规范
│   ├── PARAGRAPH_NUMBERING_SUMMARY.md
│   └── GITHUB_PAGES_SETUP.md
│
├── game/                         # 史记争霸游戏
│   ├── index.html               # 游戏入口
│   ├── game.js                  # 游戏逻辑
│   ├── styles.css               # 游戏样式
│   └── game_design.md           # 设计文档
│
├── scripts/                      # 通用工具脚本
│   ├── validate_tagging.py      # 标注验证
│   ├── convert_quotes.py        # 引号转换
│   └── ...
│
├── temp/                         # 历史开发文件
│   ├── README.md                # 说明文档
│   ├── batch_*.py               # 批处理脚本
│   └── ...                      # 历史工具存档
│
├── resources/                    # 资源文件
│
├── render_shiji_html.py         # 核心：Markdown→HTML
├── generate_all_chapters.py     # 批量生成HTML
├── extract_sections.py          # 章节信息提取
├── update_index_with_sections.py # 索引更新
├── fix_quote_issues.py          # 引号修复
└── add_section_ids_to_html.py   # 添加锚点
```

---

## 研究方法

### 十大分析方向

本项目采用跨学科的数字人文研究方法，包括：

#### 1️⃣ **社会网络分析（Social Network Analysis）**
- 构建人物关系网络图（1,820个人物节点）
- 识别核心人物、派系集团、关键桥梁
- 分析权力结构与社会网络演变

#### 2️⃣ **时空分析（Spatio-temporal Analysis）**
- 结合954个地名和390个时间标注
- 绘制历史事件时空分布地图
- 动态展示疆域变迁、战争路线

#### 3️⃣ **事件图谱（Event Knowledge Graph）**
- 提取历史事件及其要素（时间、地点、人物、类型）
- 构建事件关联网络（因果、时序、对立关系）
- 识别历史转折点与关键事件链

#### 4️⃣ **知识图谱（Knowledge Graph）**
- 整合11类实体和多种关系
- 构建Neo4j图数据库
- 支持复杂查询与知识推理

#### 5️⃣ **文体计量分析（Stylometric Analysis）**
- 量化五体（本纪、表、书、世家、列传）语言特征
- 对比词汇丰富度、句法结构、修辞手法
- 聚类分析发现相似篇章

#### 6️⃣ **主题建模（Topic Modeling）**
- 使用LDA/BERTopic发现隐含主题
- 预期主题：战争、政治、礼制、经济、思想等
- 分析主题演变与分布

#### 7️⃣ **词汇统计分析**
- 高频词Top 100、Zipf定律验证
- 专有名词分析（基于11类实体）
- 词共现网络、语义场分析

#### 8️⃣ **对话分析**
- 统计各体裁对话占比（列传35-45%，本纪30-40%）
- 分析人物语言风格
- 经典对话库构建

#### 9️⃣ **修辞手法统计**
- 识别对偶、排比、比喻、夸张、反问等
- 韵文分析（赞约130篇）
- 修辞效果研究

🔟 **量化分析（Quantitative Analysis）**
- 描述统计：字数、篇幅、人物分布
- 相关性分析：篇幅与重要性、时空关系
- 聚类与回归：人物分群、特征预测

**详细方法论**参见：[研究方法总则.md](doc/研究方法总则.md)

---

## 技术栈

### 编程语言
- 🐍 **Python 3.9+**：主要开发语言
- 📊 **R 4.0+**：统计分析
- 🌐 **JavaScript (ES6+)**：前端可视化

### 主要库与工具

**文本处理**
- jieba, spaCy, NLTK

**数据分析**
- Pandas, NumPy, SciPy

**可视化**
- Matplotlib, Seaborn, Plotly, D3.js

**网络分析**
- NetworkX, igraph, Gephi

**主题建模**
- Gensim, BERTopic

**知识图谱**
- Neo4j, py2neo, RDFlib

**地理分析**
- GeoPandas, Folium, QGIS

---

## 使用方法

### 1. 克隆项目

```bash
git clone https://github.com/baojie/shiji-kb.git
cd shiji-kb
```

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

### 3. 生成词表

```bash
python kg/kg_build_vocabularies.py
```

### 4. 生成HTML

```bash
# 生成单个章节
python render_shiji_html.py chapter_md/001_五帝本纪.tagged.md

# 批量生成所有章节
python generate_all_chapters.py
```

### 5. 查看结果

- **在线访问**：https://baojie.github.io/shiji-kb
- **本地查看**：打开 `kg/vocabularies/README.md`

---

## 数据说明

### 实体标注规则

采用11类实体标注，使用特定符号标记：

| 类别 | 标记 | 示例 |
|------|------|------|
| 人名 | `@` | @秦始皇@ |
| 地名 | `=` | =咸阳= |
| 官职 | `$` | $丞相$ |
| 时间 | `%` | %元年% |
| 朝代 | `&` | &秦& |
| 制度 | `^` | ^郡县制^ |
| 族群 | `~` | ~匈奴~ |
| 器物 | `*` | *鼎* |
| 天文 | `!` | !彗星! |
| 神话 | `?` | ?黄帝? |
| 动植物 | `🌿` | 🌿龙🌿 |

### 段落编号

采用圣经式编号（Biblical notation）：

```markdown
# [0] 章节名

## [1] 一级标题
[1.1] 段落内容...
[1.2] 段落内容...

## [2] 一级标题
### [2.1] 二级标题
[2.1.1] 段落内容...
```

---

## 项目统计

### 文本规模

- **总章节数**：130篇
- **总字数**：628,466字（约63万字）
- **已标注**：52篇（约25万字）
- **标注进度**：40%

### 实体统计

- **词条总数**：5,282个
- **标注总数**：24,249次
- **人名**：1,820个（最多）
- **地名**：954个
- **官职**：850个

### 五体分布

| 体裁 | 篇数 | 字数 | 占比 |
|------|------|------|------|
| 本纪 | 12 | 94,522 | 15.0% |
| 表 | 10 | 5,010 | 0.8% |
| 书 | 8 | 51,559 | 8.2% |
| 世家 | 30 | 165,572 | 26.3% |
| 列传 | 70 | 311,803 | 49.6% |

---

## 研究成果（计划）

### 学术产出
- 📄 研究论文（3-5篇）
- 📊 技术报告
- 📚 数据集发布

### 数据产品
- 🗂️ 史记知识图谱数据库
- 📋 史记实体词表（11类）
- 🕸️ 史记人物关系网络数据集
- 🗺️ 史记时空事件数据集

### 可视化产品
- 🌐 交互式史记数据探索平台
- 🕸️ 史记人物关系网络图
- 🗺️ 史记历史事件时空地图
- 📊 史记文本分析仪表盘

---

## TODO

- [ ] 完成剩余78章节标注（预计2-3个月）
- [ ] 实施10大高级分析（预计3-4个月）
- [ ] 开发交互式可视化平台
- [ ] 构建知识图谱数据库
- [ ] 撰写学术论文
- [ ] 发布开源数据集

**详细计划**参见：[史记高级分析计划.md](doc/史记高级分析计划.md)

---

## 贡献指南

欢迎各种形式的贡献：

### 参与方式

1. **数据标注**：帮助标注剩余章节
2. **代码贡献**：改进分析脚本和工具
3. **学术讨论**：提供历史学、语言学见解
4. **可视化设计**：设计更好的数据呈现方式
5. **Bug报告**：发现问题请提issue

### 联系方式

- GitHub Issues：https://github.com/baojie/shiji-kb/issues
- 项目主页：https://baojie.github.io/shiji-kb

---

## 参考资源

### 数据来源
- 原始文本：https://ctext.org/shiji/zh
- 历史地图：中国历史地图集、谭其骧地理数据库

### 学术文献
- 北京大学《史记》《汉书》比较研究（2022）
- 古汉语事件抽取半自动标注框架（2024）
- Moretti, F. (2013). *Distant Reading*

### 相关项目
- 中国历代人物传记数据库（CBDB）
- 殷周金文集成
- 二十五史数字化项目

---

## 许可证

### 内容许可
- 标注数据：**CC BY-NC-SA 4.0**
  - 署名-非商业性使用-相同方式共享

### 代码许可
- 分析脚本：**MIT License**

### 原始文本
- 《史记》为公有领域作品
- 现代标点本版权归中华书局

---

## 致谢

感谢以下资源和工具的支持：
- 中国哲学书电子化计划（ctext.org）
- GitHub Pages 托管服务
- 开源社区的各种优秀工具

---

## 更新日志

### 2026-02-06
- ✅ 完成52章节标注
- ✅ 生成11类实体词表（5,282词条）
- ✅ 建立研究方法总则
- ✅ 制定高级分析计划
- ✅ 更新项目文档

### 2025-12-XX
- 项目启动
- 收集原始文本
- 设计标注规则

---

**项目维护者**：[baojie](https://github.com/baojie)
**最后更新**：2026-02-06
**版本**：v0.4 (Alpha)

---

<p align="center">
  <strong>📖 让古老的历史以数字的方式重新焕发光彩 🌟</strong>
</p>
