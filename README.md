# 《史记》知识库 - 用AI让历史书活起来

> 让历史研究不再是钻故纸堆，让"皓首穷经"不再必需

[![在线访问](https://img.shields.io/badge/在线访问-GitHub%20Pages-blue)](https://baojie.github.io/shiji-kb)
[![许可证](https://img.shields.io/badge/许可证-CC%20BY--NC--SA%204.0-orange)](LICENSE)

---

## 项目愿景

**核心使命**：用AI让历史书"活"起来，让历史研究不再是钻故纸堆。

传统历史研究需要"皓首穷经"——终其一生钻研古籍，在浩如烟海的文献中寻找线索、发现规律。本项目通过AI Agent驱动的知识图谱化方法，将这一过程从数十年压缩到数周，让隐藏在历史文献中的规律和秘密更容易被发现。

**阅读革命的愿景**：

> 现在没有人再会读没有标点符号的文章，未来也不会有人愿意读没有语法加亮的文章。

正如标点符号让古文从"士大夫专利"变成"人人可读"，语法高亮将让历史文献从"专家研究对象"变成"大众认知工具"。

**关键突破**：

- 🤖 **AI驱动**：用Claude Code等AI Agent自动化处理古籍
- 🧠 **知识图谱化**：将文本转化为可查询、可分析的结构化知识
- 🎨 **认知辅助阅读**：借鉴IDE语法高亮和排版技术，通过颜色标注、结构化展示降低古文阅读门槛
  - **语法高亮是当代更强大的"标点符号"**：如同古代句读帮助断句，语法高亮用颜色和样式帮助理解语义
  - 实体语法高亮：11类实体不同颜色标注
  - 段落结构语义化：适当字体、缩进、分段、对齐降低认知负担
- 🔍 **发现隐藏规律**：通过数据分析揭示传统阅读难以发现的模式
- 🌐 **跨语言整合**：方法语言无关，可整合不同语种的历史知识
- 📚 **可扩展**：从史记到26史，再到全部古籍（4600万字→数亿字）

**当前成果（史记130篇）**：

- 📚 **文本标注**：130篇全部完成精细化语义标注
- 🏷️ **实体提取**：5,282个词条，24,249次标注（11类实体）
- 🕸️ **知识图谱**：人物、地名、官职、事件关系网络
- 🎮 **交互应用**：认知辅助阅读器（语法高亮+结构语义化）、史记争霸游戏、15个可复用Skills
- 📊 **分析方法**：统计分析、网络分析、时空分析

---

## 项目进展

### 当前状态（2026-02-08）

| 任务 | 进度 | 说明 |
|------|------|------|
| **文本标注** | 130/130 (100%) ✅ | 已完成全部130篇：本纪12篇、表10篇、书8篇、世家30篇、列传70篇 |
| **HTML生成** | 130/130 (100%) ✅ | 全部章节已生成HTML格式 |
| **实体词表** | ✅ 完成 | 提取5,282个词条，24,249次标注 |
| **研究方法** | ✅ 完成 | 建立完整的数字人文研究方法体系 |

### 最新成果

#### 1. 实体分类词表（kg/vocabularies/）

从130个已标注章节中提取的完整词表：

| 类别 | 词条数 | 典型示例 |
|------|--------|----------|
| 👤 人名 | 1,820 | 孔子(145次)、项羽(133次)、项王(123次) |
| 🗺️ 地名 | 954 | 咸阳、邯郸、长安 |
| 🎖️ 官职 | 850 | 丞相、太尉、将军 |
| 📅 时间 | 390 | 元年、正月、春秋 |
| 🏛️ 朝代 | 180 | 秦、汉、周 |
| 📜 制度 | 238 | 郡县制、封禅、正朔 |
| 👥 族群 | 61 | 匈奴、夷狄、三苗 |
| 🏺 器物 | 499 | 鼎、玉璧、印绶 |
| ⭐ 天文 | 118 | 彗星、二十八宿、朔旦 |
| 🐉 神话 | 68 | 黄帝、女娲、禹 |
| 🌿 动植物 | 104 | 龙、凤、桑 |

**详情参见**：[kg/vocabularies/README.md](kg/vocabularies/README.md)

#### 2. 研究方法体系

建立了完整的数字人文研究方法框架：

- 📖 [研究方法总则](doc/研究方法总则.md)：综合方法论
- 📋 [高级分析计划](doc/史记高级分析计划.md)：10大分析方向
- 📊 [统计分析报告](doc/史记统计分析.md)：全书统计数据

#### 3. 分析工具

本项目采用 **AI Agent 驱动的数字人文研究范式**：

- 🤖 **Claude Code**：主要开发和分析工具
  - 实体标注系统开发
  - 批量文本处理
  - HTML生成工具链
  - 知识图谱构建

- 🔧 **Skills（技能）**：专门化任务处理
  - 文档标注技能
  - 数据提取技能
  - 可视化生成技能

- 🌐 **Multi-Agent协作**：复杂任务分解
  - 并行处理多个章节
  - 协同知识抽取
  - 质量控制验证

---

## 扩展计划

### 近期目标：知识图谱深化

#### 1. 事理图谱（Event Knowledge Graph）

构建史记中的事件知识网络：

- **事件本体**：战争、政变、改革、会盟、封禅等事件类型
- **事件要素**：时间、地点、参与者、原因、经过、结果
- **因果关系**：事件之间的因果链条和影响网络
- **典型案例**：鸿门宴、破釜沉舟、约法三章等重大历史事件

#### 2. 时间图谱（Temporal Knowledge Graph）

构建完整的历史时间轴：

- **绝对时间轴**：公元纪年、王朝纪年对照
- **相对时序**：事件先后顺序、同时发生关系
- **历法系统**：夏历、周历、秦历、汉历转换
- **时间粒度**：年、月、日、时辰等多级精度

#### 3. 表格结构化（Tables Structuring）

**背景问题**：史记十篇"表"（编年表、封侯表、世系表）采用复杂的二维/多维表格形式，是全书最难阅读和理解的部分。传统纸质或纯文本格式难以查询、分析和发现规律。

**解决方案**：让"表"活起来，借鉴现代数据可视化方法

**数据结构化**：

- 将10个表转换为机器可读的JSON格式
- 编年表：时间轴 × 政治实体 × 事件（如秦楚之际月表）
- 封侯表：人物 × 爵位 × 时间线 × 功绩（如高祖功臣侯者年表）
- 世系表：家族关系树（如三代世表）

**交互式展示**（计划功能）：

- 🕐 **时间轴视图**：横向滚动的历史事件时间线
- 🔍 **多维筛选**：按人物、地点、时间、事件类型查询
- 📊 **统计分析**：封侯人数分布、爵位存续、地理热力图
- 🕸️ **关系网络**：同时期人物/事件关系可视化
- 💾 **数据导出**：CSV、JSON、Markdown格式导出

**深度整合**：

- 表格数据与本纪/世家/列传内容双向链接
- 跨表查询（例如："萧何在哪些表中出现？"）
- 与知识图谱整合（人物、地点、时间统一）

**实施策略**：

- **Phase 1**：MVP试点（016_秦楚之际月表）- 建立数据模板和基础展示
- **Phase 2**：核心3表（016、018、022）- 完整功能开发
- **Phase 3**：全部10表 + 高级分析

**当前状态**：

- ✅ 已创建 `tables/` 目录结构
- ✅ 已设计JSON数据模型
- ✅ 已创建016表示例数据（6个时间点）
- 📝 待开发：交互式查看器、完整数据录入

**详细计划**：[表格结构化计划](doc/表格结构化计划.md) | [示例数据](tables/data/016_秦楚之际月表_示例.json)

### 中期目标：二十六史与通鉴系列

#### 二十六史（约4000万字）

**已完成**：

- ✅ 史记（西汉·司马迁，63万字）

**规划处理**：

- 汉书、后汉书、三国志（两汉三国）
- 晋书至隋书（魏晋南北朝8史）
- 南史、北史（南北朝通史）
- 旧唐书、新唐书（唐代双史）
- 旧五代史、新五代史（五代双史）
- 宋史、辽史、金史、元史（宋辽金元）
- 明史、新元史、清史稿（明清民国）

#### 通鉴系列（约600-700万字）

- **资治通鉴**（司马光，294卷）：战国至五代
- **续资治通鉴**（毕沅，220卷）：宋元明
- **明通鉴**（夏燮，90卷）：明代编年
- **清通鉴**（夏孙桐）：清代编年
- **资治通鉴外纪**（刘恕）：上古至战国补充
- **通鉴纪事本末**（袁枢）：按事件重组

**总规模**：约4600-4700万字，覆盖中国5000年历史

### 远期愿景：大规模古籍数字化

本项目验证的AI Agent驱动方法论，可推广到：

- 诸子百家（老庄孔孟、韩非墨子等）
- 四库全书（3000多部典籍）
- 佛道经典（大藏经、道藏）
- 诗词文集（全唐诗、全宋词等）

**核心价值**：

- 🔄 **方法可复制**：标准化的处理流程
- 🤖 **Agent驱动**：自动化、可扩展
- 🎓 **Skills提取**：从文献中提炼可复用知识模块（已从史记中提取15个专业Skills）
- 🌐 **知识互联**：构建跨文献的知识图谱

---

## 目录结构

```
shiji-kb/
├── README.md                      # 项目说明
├── TODO.md                        # 任务清单
│
├── docs/                          # 网站与原始文本
│   ├── index.html                # GitHub Pages首页
│   ├── chapters/                 # HTML格式章节
│   └── original_text/            # 130篇原始文本
│
├── chapter_md/                    # 标注后的Markdown文件
│   ├── 001_五帝本纪.tagged.md   # 已标注
│   ├── 002_夏本纪.tagged.md
│   └── ...                       # 130/130全部完成 ✅
│
├── kg/                           # 知识图谱数据
│   ├── README.md                 # 知识图谱说明
│   ├── vocabularies/             # 实体分类词表（11类）
│   ├── relations/                # 人物关系网络
│   ├── genealogy/                # 帝王家谱
│   ├── kg_build_vocabularies.py      # 词表生成脚本
│   ├── kg_extract_all_relations.py   # 关系提取脚本
│   ├── kg_extract_family_relations.py
│   ├── kg_extract_imperial_genealogy.py
│   └── kg_extract_flora_fauna.py
│
├── doc/                          # 技术文档
│   ├── 研究方法总则.md            # 研究方法体系
│   ├── 史记高级分析计划.md        # 高级分析方案
│   ├── 史记统计分析.md            # 统计数据报告
│   ├── ENTITY_TAGGING_SCHEME.md  # 实体标注规范
│   ├── PARAGRAPH_NUMBERING_SUMMARY.md
│   └── GITHUB_PAGES_SETUP.md
│
├── game/                         # 史记争霸游戏
│   ├── index.html               # 游戏入口
│   ├── game.js                  # 游戏逻辑
│   ├── styles.css               # 游戏样式
│   └── game_design.md           # 设计文档
│
├── scripts/                      # 通用工具脚本
│   ├── validate_tagging.py      # 标注验证
│   ├── convert_quotes.py        # 引号转换
│   └── ...
│
├── temp/                         # 历史开发文件
│   ├── README.md                # 说明文档
│   ├── batch_*.py               # 批处理脚本
│   └── ...                      # 历史工具存档
│
├── resources/                    # 资源文件
│
├── render_shiji_html.py         # 核心：Markdown→HTML
├── generate_all_chapters.py     # 批量生成HTML
├── extract_sections.py          # 章节信息提取
├── update_index_with_sections.py # 索引更新
├── fix_quote_issues.py          # 引号修复
└── add_section_ids_to_html.py   # 添加锚点
```

---

## 研究方法

本项目采用AI Agent驱动的数字人文研究方法，核心工作流程：

### 1. 文本标注与结构化

- **实体标注**：11类实体精细标注（人名、地名、官职、时间、朝代、制度、族群、器物、天文、神话、动植物）
- **认知辅助阅读系统**：
  - **语法高亮——当代更强大的"标点符号"**：
    - 如同古代"句读"帮助断句理解，语法高亮用颜色和样式帮助理解语义结构
    - 为11类历史实体赋予不同颜色和视觉样式（人名蓝色、地名绿色、官职红色等）
    - 一眼识别关键信息：人物、地点、官职、时间等核心要素
    - 从"标点断句"进化到"语义着色"——认知辅助的革命性提升
  - **段落结构语义化**：进行段落结构的语义分析，优化视觉呈现
    - 适当的字体选择（正文、引文、注释使用不同字体）
    - 智能缩进（对话层级、列表结构用缩进表达）
    - 合理分段（长段落按语义拆分，提高可读性）
    - 视觉对齐（诗歌、表格、列表等结构化内容对齐显示）
  - **核心价值**：降低古文阅读认知负担，让读者轻松理解历史文献
  - **效果**：就像IDE帮助程序员理解代码，认知辅助系统帮助读者理解历史文献
- **段落编号**：Purple Numbers系统，支持精确引用和段落级导航
- **对话标识**：识别引语和对话内容，保留原文语境
- **格式转换**：Markdown → HTML，保持语义结构

### 2. 实体提取与词表构建
- **词表生成**：从130章节提取5,282个词条，24,249次标注
- **分类整理**：按11类实体分类，统计词频和分布
- **关系识别**：提取人物关系（家族、政治、师徒等）
- **家谱构建**：建立帝王世系图（五帝、夏、商、周、秦、汉）

### 3. 知识图谱构建
- **实体网络**：人名1,820个，地名954个，官职850个
- **关系抽取**：父子、母子、君臣、师徒等多种关系类型
- **数据组织**：结构化存储为Markdown和JSON格式
- **未来扩展**：计划导入Neo4j图数据库

### 4. 统计分析
- **文本规模**：130篇，总计628,466字
- **五体分布**：本纪15%、表0.8%、书8.2%、世家26.3%、列传49.6%
- **实体分布**：人名最多(1,820)，其次是地名(954)和官职(850)

### 5. 可视化展示
- **网页生成**：全部130章节HTML化，支持实体高亮和段落导航
- **交互功能**：可点击段落号、实体悬停提示、引语样式区分
- **GitHub Pages**：在线展示，公开访问

**核心特点**：使用Claude Code和AI Agent完成大部分开发和标注工作，强调可重复性和自动化

---

## 技术栈

### AI Agent 工具链

**核心平台**
- 🤖 **Claude Code**：AI驱动的开发环境
- 🧠 **Claude Sonnet 4.5**：大语言模型（LLM）
- 🔧 **Claude Skills**：专门化任务技能
- 🌐 **Multi-Agent System**：并行协作架构

**Agent 能力**
- 📝 代码生成与编辑
- 🔍 文本分析与标注
- 📊 数据提取与转换
- 🧪 质量验证与测试
- 📖 文档生成与维护

### 辅助技术

**编程语言**
- 🐍 **Python 3.9+**：脚本开发
- 🌐 **JavaScript (ES6+)**：前端交互
- 📝 **Markdown**：文档标准

**数据格式**
- JSON：结构化数据
- Markdown：标注文本
- HTML/CSS：网页展示

**版本控制**
- Git/GitHub：代码管理
- GitHub Pages：静态网站托管

**未来扩展**
- Neo4j：知识图谱数据库
- D3.js：交互式可视化
- React：前端框架

---

## 使用方法

### 1. 克隆项目

```bash
git clone https://github.com/baojie/shiji-kb.git
cd shiji-kb
```

### 2. 安装依赖

```bash
pip install -r requirements.txt
```

### 3. 生成词表

```bash
python kg/kg_build_vocabularies.py
```

### 4. 生成HTML

```bash
# 生成单个章节
python render_shiji_html.py chapter_md/001_五帝本纪.tagged.md

# 批量生成所有章节
python generate_all_chapters.py
```

### 5. 查看结果

- **在线访问**：https://baojie.github.io/shiji-kb
- **本地查看**：打开 `kg/vocabularies/README.md`

---

## 数据说明

### 实体标注规则

采用11类实体标注，使用特定符号标记：

| 类别 | 标记 | 示例 |
|------|------|------|
| 人名 | `@` | @秦始皇@ |
| 地名 | `=` | =咸阳= |
| 官职 | `$` | $丞相$ |
| 时间 | `%` | %元年% |
| 朝代 | `&` | &秦& |
| 制度 | `^` | ^郡县制^ |
| 族群 | `~` | ~匈奴~ |
| 器物 | `*` | *鼎* |
| 天文 | `!` | !彗星! |
| 神话 | `?` | ?黄帝? |
| 动植物 | `🌿` | 🌿龙🌿 |

### 段落编号

采用圣经式编号（Biblical notation）：

```markdown
# [0] 章节名

## [1] 一级标题
[1.1] 段落内容...
[1.2] 段落内容...

## [2] 一级标题
### [2.1] 二级标题
[2.1.1] 段落内容...
```

---

## 项目统计

### 文本规模

- **总章节数**：130篇
- **总字数**：628,466字（约63万字）
- **已标注**：130篇（全部完成）✅
- **标注进度**：100% ✅

### 实体统计

- **词条总数**：5,282个
- **标注总数**：24,249次
- **人名**：1,820个（最多）
- **地名**：954个
- **官职**：850个

### 五体分布

| 体裁 | 篇数 | 字数 | 占比 |
|------|------|------|------|
| 本纪 | 12 | 94,522 | 15.0% |
| 表 | 10 | 5,010 | 0.8% |
| 书 | 8 | 51,559 | 8.2% |
| 世家 | 30 | 165,572 | 26.3% |
| 列传 | 70 | 311,803 | 49.6% |

---

## TODO

- [x] ~~完成全部130章节标注~~ ✅ 已完成
- [x] ~~生成全部130章节HTML~~ ✅ 已完成
- [ ] 实施10大高级分析（使用Agent方法）
- [ ] 开发交互式可视化平台
- [ ] 构建Neo4j知识图谱数据库
- [ ] 完善知识图谱数据（关系、事件、时空）
- [ ] 撰写学术论文
- [ ] 发布开源数据集

**详细计划**参见：[史记高级分析计划.md](doc/史记高级分析计划.md)

---

## 贡献指南

欢迎各种形式的贡献：

### 参与方式

1. **知识图谱完善**：完善人物关系、事件抽取
2. **代码贡献**：改进分析脚本和工具
3. **学术讨论**：提供历史学、语言学见解
4. **可视化设计**：设计更好的数据呈现方式
5. **Bug报告**：发现问题请提issue

### 联系方式

- GitHub Issues：https://github.com/baojie/shiji-kb/issues
- 项目主页：https://baojie.github.io/shiji-kb

---

## 参考资源

### 数据来源
- 原始文本：https://ctext.org/shiji/zh
- 历史地图：中国历史地图集、谭其骧地理数据库

---

## 许可证

### 内容许可
- 标注数据：**CC BY-NC-SA 4.0**
  - 署名-非商业性使用-相同方式共享

### 代码许可
- 分析脚本：**MIT License**

### 原始文本
- 《史记》为公有领域作品
- 现代标点本版权归中华书局

---

## 致谢

感谢以下资源和工具的支持：

- **Claude Code & Claude Sonnet 4.5**：项目主要开发工具和AI助手
- **中国哲学书电子化计划**（ctext.org）：原始文本来源
- **GitHub Pages**：网站托管服务
- **Netlify**：游戏部署平台
- 开源社区的各种优秀工具

---

## 更新日志

查看完整更新日志：[CHANGELOG.md](CHANGELOG.md)

### 最新进展 (2026-02-08)

- ✅ **完成全部130章节标注**（本纪12、表10、书8、世家30、列传70）
- ✅ **完成全部130章节HTML生成**
- 🎮 **史记争霸游戏**初始版本上线
- 📁 **项目结构重构**（kg/, doc/, temp/, private/目录）
- 🔒 **隐私保护**（移除所有个人路径信息）
- 📊 **知识图谱系统**完善（5个提取脚本）

---

**项目维护者**：[baojie](https://github.com/baojie)
**最后更新**：2026-02-08

---

<p align="center">
  <strong>📖 让古老的历史以数字的方式重新焕发光彩 🌟</strong>
</p>
