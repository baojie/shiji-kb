# 111-130章节处理相关文件说明

## 创建的文件列表

### 1. 核心处理脚本
- **文件**: `process_chapters_111_130.py`
- **用途**: 主要的Python处理脚本，使用Claude API进行智能标注
- **特点**:
  - 支持断点续传
  - 自动保存进度
  - 详细的错误处理
  - 特别优化了130_太史公自序的处理
- **运行**: `python3 scripts/process_chapters_111_130.py`

### 2. 便捷运行脚本
- **文件**: `run_111_130.sh`
- **用途**: Shell脚本，简化运行流程，自动检查API密钥
- **特点**:
  - 检查环境变量中的API密钥
  - 支持从 `~/.anthropic_key` 读取密钥
  - 自动切换到项目目录
- **运行**: `./scripts/run_111_130.sh`

### 3. 状态检查脚本
- **文件**: `check_111_130_status.sh`
- **用途**: 检查111-130章节的处理状态
- **功能**:
  - 检查输入文件（20个）
  - 检查输出文件
  - 显示进度信息
  - 列出待处理章节
  - 特别关注130_太史公自序
- **运行**: `./scripts/check_111_130_status.sh`

### 4. 快速开始指南
- **文件**: `../PROCESS_111_130.md`（项目根目录）
- **用途**: 完整的使用指南
- **内容**:
  - 快速开始步骤
  - 章节列表和说明
  - 130_太史公自序特别说明
  - 标注规则详解
  - 验证和后续处理
  - 问题排查

### 5. 一分钟快速指南
- **文件**: `QUICKSTART_111_130.md`
- **用途**: 最简洁的使用说明
- **特点**: 一分钟快速上手

### 6. 详细技术文档
- **文件**: `README_111_130.md`
- **用途**: 完整的技术文档
- **内容**:
  - 详细的功能说明
  - 完整的标注规则
  - 输出格式说明
  - 各类章节的特殊处理说明
  - 预期处理时间和Token消耗
  - 验证方法
  - 问题排查指南

### 7. 本文件
- **文件**: `FILES_CREATED_111_130.md`
- **用途**: 文件清单和说明

## 文件依赖关系

```
用户
 │
 ├─> QUICKSTART_111_130.md          # 快速了解
 │    └─> run_111_130.sh            # 快速运行
 │         └─> process_chapters_111_130.py  # 实际处理
 │
 ├─> PROCESS_111_130.md             # 完整指南
 │    ├─> check_111_130_status.sh  # 检查状态
 │    └─> run_111_130.sh            # 运行处理
 │
 └─> README_111_130.md              # 技术细节
      └─> process_chapters_111_130.py  # 了解实现
```

## 使用流程

### 新手推荐流程
1. 阅读 `QUICKSTART_111_130.md`（1分钟）
2. 设置API密钥
3. 运行 `./scripts/run_111_130.sh`
4. 等待完成

### 完整流程
1. 阅读 `PROCESS_111_130.md`（5分钟）
2. 运行 `./scripts/check_111_130_status.sh` 检查状态
3. 设置API密钥
4. 运行 `./scripts/run_111_130.sh`
5. 验证结果

### 技术研究流程
1. 阅读 `README_111_130.md`（15分钟）
2. 阅读 `process_chapters_111_130.py` 源码
3. 了解标注规则和特殊处理
4. 自定义修改（如需要）
5. 运行处理

## 输入输出

### 输入文件位置
```
/home/baojie/work/shiji-kb/docs/original_text/
├── 111_卫将军骠骑列传.txt
├── 112_平津侯主父列传.txt
├── ...
└── 130_太史公自序.txt
```

### 输出文件位置
```
/home/baojie/work/shiji-kb/chapter_md/
├── 111_卫将军骠骑列传.tagged.md
├── 112_平津侯主父列传.tagged.md
├── ...
└── 130_太史公自序.tagged.md
```

### 进度文件
```
/home/baojie/work/shiji-kb/progress_111_130.json
```

## 标注示例

### 输入（原文片段）
```
大将军卫青者，平阳人也。其父郑季，为吏，给事平阳侯家，与侯妾卫媪通，生青。
```

### 输出（标注后）
```
$大将军$@卫青@者，=平阳=人也。其父@郑季@，为$吏$，给事=平阳侯=家，与侯妾@卫媪@通，生@青@。
```

## 11类实体标注

1. `@人名@` - 卫青、霍去病、司马迁
2. `=地名=` - 长安、茂陵、河西
3. `$官职$` - 大将军、骠骑将军、太史令
4. `%时间%` - 元光五年、元狩四年
5. `&朝代&` - 汉、秦、楚
6. `^制度^` - 封禅、太初历
7. `~族群~` - 匈奴、南越、东越、大宛
8. `*器物*` - 金人、玉玺
9. `!天文!` - 太初历、北斗
10. `?神话?` - 封狼居胥
11. `🌿动植物🌿` - 马、羊

## 特殊章节说明

### 130_太史公自序
这是《史记》最重要的篇章，包含：
- 司马氏家世（司马错→司马昌→司马靳→司马谈→司马迁）
- 司马迁生平（游历、任职、李陵之祸、著书）
- 《史记》体例说明
- 130篇目录总序
- 著述宗旨

**处理要求最高**，需要特别细致的标注！

## 处理统计预期

### 单个章节
- 人名标注：50-200个
- 地名标注：30-100个
- 族群标注：10-50个（民族列传更多）
- 官职标注：20-80个
- 其他标注：若干

### 全部章节
- 总人名标注：约1000-3000个
- 总地名标注：约500-1500个
- 总标注数：约3000-8000个

## 质量保证

脚本包含以下质量保证机制：
1. ✅ 使用Claude Sonnet 4模型（高质量）
2. ✅ Temperature=0（确保一致性）
3. ✅ 详细的System Prompt（明确标注规则）
4. ✅ 特殊章节特别提示（如130章）
5. ✅ 输出统计验证

## 下一步

选择一个入口开始：

### 最快速度
```bash
export ANTHROPIC_API_KEY='your-key'
./scripts/run_111_130.sh
```

### 先检查状态
```bash
./scripts/check_111_130_status.sh
```

### 了解更多
- 快速指南：`cat scripts/QUICKSTART_111_130.md`
- 完整指南：`cat PROCESS_111_130.md`
- 技术文档：`cat scripts/README_111_130.md`

## 技术支持

如遇到问题：
1. 查看 `README_111_130.md` 的"问题排查"部分
2. 检查 `progress_111_130.json` 了解进度
3. 查看脚本输出的错误信息

## 批处理优势

相比手工处理，批处理脚本的优势：
- ⚡ 自动化：无需手动处理每个章节
- 🔄 断点续传：中断后可继续
- 📊 统计信息：自动统计标注质量
- 🎯 一致性：统一的标注规则
- 🛡️ 错误处理：自动记录失败原因
- ⏱️ 时间节省：预计节省数小时手工时间

## 预计收益

处理完111-130章节后：
- ✅ 获得20个完整标注的列传章节
- ✅ 包括最重要的《太史公自序》
- ✅ 完成《史记》列传部分的标注
- ✅ 为后续的关系提取、知识图谱构建打下基础
- ✅ 完整的《史记》知识库基础建设

## 总结

现在你拥有了一套完整的批处理工具：
1. 6个文档文件（指南、文档、清单）
2. 3个可执行脚本（处理、运行、检查）
3. 20个待处理章节（全部就绪）
4. 1个进度追踪系统（自动管理）

**准备好了吗？开始处理吧！**
