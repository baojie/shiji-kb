# 史记"表"结构化数据

本目录包含史记十篇"表"的结构化数据和交互式展示工具。

---

## 项目背景

史记130篇中，"表"（十篇）采用复杂的二维甚至多维表格形式，传统纸质或纯文本格式难以阅读和分析。本项目旨在：

- 📊 **结构化数据**：将表格转换为机器可读的JSON格式
- 🌐 **交互展示**：提供在线浏览、查询、过滤功能
- 🔗 **深度链接**：与本纪/世家/列传内容互相关联
- 📈 **数据分析**：支持统计分析、可视化、数据导出

---

## 目录结构

```
tables/
├── README.md              # 本文档
├── data/                  # 结构化数据（JSON格式）
│   ├── 016_秦楚之际月表_示例.json  # 示例数据模板
│   ├── 016_秦楚之际月表.json       # 完整数据（待完成）
│   ├── 018_高祖功臣侯者年表.json   # （待完成）
│   └── ...
├── interactive/           # 交互式展示页面（待开发）
│   ├── index.html        # 表格总览
│   ├── viewer.html       # 通用表格查看器
│   ├── viewer.js         # 交互逻辑
│   └── styles.css        # 样式
└── scripts/              # 数据处理脚本（待开发）
    ├── validate_data.py  # 数据验证
    └── export_csv.py     # 导出CSV格式
```

---

## 史记十表清单

| 编号 | 表名 | 类型 | 时间跨度 | 状态 | 优先级 |
|------|------|------|----------|------|--------|
| 013 | 三代世表 | 世系表 | 黄帝-共和 | 📝 计划中 | 中 |
| 014 | 十二诸侯年表 | 编年表 | 春秋时期 | 📝 计划中 | 高 |
| 015 | 六国年表 | 编年表 | 战国时期 | 📝 计划中 | 高 |
| 016 | 秦楚之际月表 | 编年表 | 前209-前202 | ✏️ 示例中 | **最高** |
| 017 | 汉兴以来诸侯王年表 | 封国表 | 西汉 | 📝 计划中 | 高 |
| 018 | 高祖功臣侯者年表 | 封侯表 | 西汉初 | 📝 计划中 | **最高** |
| 019 | 惠景间侯者年表 | 封侯表 | 惠帝-景帝 | 📝 计划中 | 中 |
| 020 | 建元以来侯者年表 | 封侯表 | 武帝 | 📝 计划中 | 中 |
| 021 | 建元已来王子侯者年表 | 封侯表 | 武帝 | 📝 计划中 | 中 |
| 022 | 汉兴以来将相名臣年表 | 官职表 | 西汉 | 📝 计划中 | **最高** |

**图例**：
- ✅ 已完成
- 🚧 开发中
- ✏️ 示例/原型
- 📝 计划中

---

## 数据模型说明

### 编年表类（014-017, 022）

**特点**：按时间顺序记录多个政治实体的重大事件

**数据结构**：
```json
{
  "table_info": {
    "id": "016",
    "title": "秦楚之际月表",
    "type": "chronological_table",
    "time_range": {
      "start": {"year": -209, "month": 7},
      "end": {"year": -202, "month": 10}
    }
  },
  "timeline_data": [
    {
      "date": {"year": -209, "month": 7},
      "entities": {
        "秦": {
          "ruler": {...},
          "events": [...]
        },
        "楚": {...}
      }
    }
  ]
}
```

**示例文件**：[016_秦楚之际月表_示例.json](data/016_秦楚之际月表_示例.json)

### 封侯表类（018-021）

**特点**：记录功臣封侯、爵位传承

**数据结构**：
```json
{
  "table_info": {
    "id": "018",
    "title": "高祖功臣侯者年表"
  },
  "persons": [
    {
      "name": "萧何",
      "title": "酂侯",
      "封地": "酂",
      "户数": 8000,
      "初封时间": {"year": -201},
      "功绩": "镇守关中，供应军粮",
      "timeline": [
        {"year": -201, "event": "初封"},
        {"year": -193, "event": "卒"},
        {"year": -193, "successor": "萧禄", "relation": "子"}
      ]
    }
  ]
}
```

### 世系表类（013）

**特点**：记录王朝世系、家族关系

**数据结构**：
```json
{
  "genealogy": {
    "黄帝": {
      "children": ["少昊", "昌意"],
      "spouse": ["嫘祖"],
      "dynasty": "五帝"
    }
  }
}
```

---

## 计划功能

### 交互式查看器

#### 1. 时间轴视图
- 横向滚动的时间线
- 多势力/多人物并行显示
- 事件气泡悬停显示详情
- 点击跳转到相关章节

#### 2. 筛选与查询
- 按人物、地点、事件类型筛选
- 时间范围滑块
- 关键词搜索
- 高级组合查询

#### 3. 统计分析
- 封侯人数分布图
- 爵位存续时长统计
- 地理分布热力图
- 人物关系网络图

#### 4. 数据导出
- CSV格式（Excel分析）
- JSON格式（程序处理）
- Markdown表格（文档引用）

---

## 开发路线图

### Phase 1: MVP原型（示例阶段）

**目标**：完成1个表的数据模板和基础展示

- [x] 创建目录结构
- [x] 设计JSON数据模型
- [x] 创建016表示例数据（6个时间点）
- [ ] 开发基础HTML查看器
- [ ] 实现简单时间轴视图
- [ ] 部署到GitHub Pages

**试点表格**：016_秦楚之际月表
**预计周期**：2-3周

### Phase 2: 核心表格完成

**目标**：完成3个最重要的表

- [ ] 016_秦楚之际月表（完整数据）
- [ ] 018_高祖功臣侯者年表
- [ ] 022_汉兴以来将相名臣年表

**新增功能**：
- 多维筛选器
- 统计分析面板
- 关系网络图
- 数据导出功能

**预计周期**：2-3个月

### Phase 3: 全部完成

- [ ] 完成全部10个表
- [ ] 跨表查询功能
- [ ] 与知识图谱整合
- [ ] 智能问答接口

**预计周期**：累计6-9个月

---

## 数据来源

### 主要来源
1. **中华书局《史记》标点本** - 最权威版本
2. **原始文本** - `docs/original_text/`（序言部分）
3. **CBDB数据库** - 中国历代人物传记数据库（部分功臣数据）

### 数据录入方法
- **Phase 1**：手工录入（质量可控）
- **Phase 2**：OCR + AI辅助
- **Phase 3**：利用现有数据库

---

## 数据质量保证

### 验证规则
1. ✅ 时间合法性检查（年月日范围）
2. ✅ 实体引用完整性（人名、地名在词表中）
3. ✅ 交叉引用验证（章节引用存在）
4. ✅ 数据完整性（必填字段检查）

### 数据标准
- 使用公元纪年（负数表示公元前）
- 人名、地名、官职统一标准（与主词表一致）
- 所有事件提供出处引用

---

## 使用示例

### 读取表格数据

```python
import json

# 读取JSON数据
with open('tables/data/016_秦楚之际月表.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 获取基本信息
print(data['table_info']['title'])  # 秦楚之际月表
print(f"时间跨度: {data['table_info']['time_range']}")

# 遍历时间线
for entry in data['timeline_data']:
    date = entry['date']
    print(f"\n{date['era']} ({date['year']}年{date['month']}月)")

    for country, info in entry['entities'].items():
        print(f"  {country}: {info['ruler']['name']}")
        for event in info.get('events', []):
            print(f"    - {event['description']}")
```

### 查询特定事件

```python
# 查找所有"起义"类型事件
uprisings = []
for entry in data['timeline_data']:
    for country, info in entry['entities'].items():
        for event in info.get('events', []):
            if event['type'] == '起义':
                uprisings.append({
                    'date': entry['date'],
                    'description': event['description'],
                    'participants': event['participants']
                })

print(f"共发生{len(uprisings)}次起义")
```

---

## 技术栈

### 数据格式
- **JSON** - 结构化数据存储
- **CSV** - 导出格式（Excel兼容）

### 前端技术（计划）
- **D3.js** - 时间轴、网络图可视化
- **DataTables** - 表格排序、过滤
- **Leaflet** - 地理地图展示
- **Chart.js** - 统计图表

### 开发工具
- **Claude Code** - AI驱动开发
- **Python** - 数据处理脚本
- **GitHub Pages** - 静态网站托管

---

## 参考文档

- [表格结构化计划](../doc/表格结构化计划.md) - 详细实施方案
- [项目README](../README.md) - 总体项目说明
- [实体标注规范](../doc/ENTITY_TAGGING_SCHEME.md) - 实体标准

---

## 贡献指南

欢迎参与表格数据录入和功能开发！

### 数据贡献
1. 选择一个表格（参考优先级）
2. 按照JSON模板录入数据
3. 运行验证脚本检查格式
4. 提交Pull Request

### 代码贡献
1. 开发交互式查看器功能
2. 改进数据可视化
3. 优化查询性能
4. 添加新的分析维度

### 联系方式
- GitHub Issues: https://github.com/baojie/shiji-kb/issues

---

**创建时间**：2026-02-08
**最后更新**：2026-02-08
**当前状态**：示例/原型阶段
**维护者**：[@baojie](https://github.com/baojie)
