# 《史记》语义化 Markdown 转化逻辑

本文档旨在详述将《史记》原始或改进后的文本（TXT）转化为具有语义结构的 Markdown 格式的准则。核心原则是**体现文本的内在逻辑关系**。

---

## 1. 层级结构 (Hierarchical Structure)

### 1.1 标题等级

- **一级标题 (`#`)**: 章节全名 (如 `# 五帝本纪`)。
- **二级标题 (`##`)**: 主体人物、时期或大的叙事单元 (如帝王名 `## 黄帝`)。
- **三级标题 (`###`)**: 核心人物下的具体维度，如“疆域治理”、“家世背景”、“轶事传说”等。

### 1.2 内容分隔

- 在重大的逻辑转换点（如从一位帝王切换到另一位帝王）使用水平分割线 (`---`)。

---

## 2. 并列结构 (Parallel Structure)

对于古代汉语中常见的列举性、并列性内容，应当采用 Markdown 列表以提升结构化水平：

- **血缘/世系**: 如列举子嗣及其封地。
- **官制/职责**: 明确各官员的职能。
- **地理/方位**: 如东南西北的具体疆域描述。
- **历法/节气**: 如羲和四子的季节职责。

**示例**:

> - 其一曰**玄嚣**，是为青阳；
> - 其二曰**昌意**，降居若水。

---

## 3. 语义化增强 (Semantic Enhancement)

利用特定的 Markdown 语法来区分不同性质的文本内容：

### 3.1 轶事与侧写

- 针对篇幅较长、具有故事性或独立性的片段（如“舜受磨难”），使用 **警告/注意框 (`> [!NOTE]`)** 进行视觉隔离，突出其叙事地位。

### 3.2 评价与总结

- **太史公曰**: 保留作为章节收尾的固定板块，使用 `## 太史公曰`。
- **赞 (Zan)**: 针对文末押韵的总结性文字，使用 **引用块 (`> `)** 格式，体现其文学性。

### 3.3 实体高亮

为了提升古文阅读体验，对不同类型的命名实体采用不同的视觉标记：

- **人名**: 棕色+下划线 (`<span style="color: #8B4513; text-decoration: underline;">人名</span>`)
- **地名**: 深黄色+下划线 (`<span style="color: #B8860B; text-decoration: underline;">地名</span>`)
- **官职**: 深红色 (`<span style="color: #8B0000;">官职</span>`)
- **时间**: 青色 (`<span style="color: #008B8B;">时间</span>`)
- **朝代/国号/氏族**: 紫色+高亮 (`<span style="color: #9370DB; background-color: #F0E6FF;">氏族</span>`)
- **书名**: 传统书名号 (`《书名》`)
- **族群/部落**: 深灰绿色 (`<span style="color: #2F4F4F;">族群</span>`)
- **器物/礼器**: 秘鲁棕色 (`<span style="color: #CD853F;">器物</span>`)
- **制度/典章**: 钢青色 (`<span style="color: #4682B4;">制度</span>`)
- **天文/历法**: 深蓝紫色 (`<span style="color: #483D8B;">天文</span>`)
- **传说生物/神话**: 深洋红色 (`<span style="color: #8B008B;">神话</span>`)

**示例**:
```markdown
<span style="color: #8B4513; text-decoration: underline;">黄帝</span>居<span style="color: #B8860B; text-decoration: underline;">轩辕之丘</span>，而娶於<span style="color: #B8860B; text-decoration: underline;">西陵</span>之女，是为<span style="color: #8B4513; text-decoration: underline;">嫘祖</span>。
<span style="color: #8B4513; text-decoration: underline;">舜</span>为<span style="color: #8B0000;">司空</span>，可美帝功。
<span style="color: #9370DB; background-color: #F0E6FF;">神农氏</span>世衰，诸侯相侵伐。
<span style="color: #8B4513; text-decoration: underline;">舜</span><span style="color: #008B8B;">年二十</span>以孝闻。
```

---

## 4. 逻辑关系识别准则

在处理每一章时，需识别以下语义信号：

- **起始标志**: “XX者”、“维XX”等通常预示新人物或新篇章的开启。
- **职责分配**: “命XX”、“以XX为XX”等语义对应列表。
- **时间演进**: 描述人物一生阶段（如“年二十”、“年三十”）的文字，可考虑使用加粗引导词或列表。
- **方位描述**: “东至于”、“西至于”等具有强对比性的文字对应列表或表格。

---

## 5. 预期效果

通过上述逻辑转化，文本从单一的线性流转变为**多维结构体**。读者可以：

1. 快速通过大纲了解全篇脈络。
2. 直观对比并列内容（如职能分布）。
3. 区分叙事内容与作者点评。

---

## 6. 溯源与编号系统 (Traceability & Numbering)

为了确保文本的可溯源性，并支持细粒度的引用，采用两级编号系统。

### 6.1 原始段落编号

- TXT 源文件中的每一个自然段落都分配一个唯一的序号，格式为 `[N]` (如 `[1]`, `[2]`)。
- 此序号在 Markdown 转化过程中**必须保留**，且置于该段落（或该段落拆分出的第一部分）的开头。

### 6.2 结构化子编号

- 当源文件中的一个段落因为语义结构（如列表、对话、分项描述）被拆分为多个 Markdown 区块时，使用子编号。
- 格式为 `[N.M]` (如 `[4.1]`, `[4.2]`)。
- **目的**: 确保源文件的一个段落 `[N]` 的内容完整对应 Markdown 中的 `[N]` 及其所有 `[N.M]` 子项，不重不漏。

### 6.3 忠实原则 (Fidelity)

- **原文保留**: Markdown 中的所有文本内容必须与源文件完全一致。
- **禁止修改**: 严禁修改、删除或增加原文中的任何汉字。
- **仅增格式**: 所有的转化工作仅限于添加 Markdown 标记（标题、列表符号、粗体等）和编号标签，绝不触碰文本本身。

---

## 7. 语义拆分与列表化规范 (Semantic Granularity & List Formatting)

为了提升长段落的可读性，采用两种不同的处理策略：

### 7.1 长段落的语义拆分 (Semantic Splitting)

- **场景**: 当一个原始段落 `[N]` 包含多个明显的独立事件、转折或时间跨度较大的叙事时。
- **操作**: 将其物理拆分为多个子段落。
- **编号规则**:
  - 第一个子段落保留原编号 `[N]` (或者 `[N]` 后接空行，子段落从 `[N.1]` 开始，视具体语境而定，通常推荐**拆分后的第一个子段落沿用 `[N]`，后续用 `[N.M]`**；或者保留 `[N]` 作为总括，下面全部用 `[N.M]`，见五帝本纪案例)。
  - **推荐模式**:

    ```markdown
    [N] (总述或第一部分) ...

    [N.1] (第二部分) ...

    [N.2] (第三部分) ...
    ```

### 7.2 对话与并列结构的列表化 (List Formatting)

- **场景**: 当段落内包含密集的对话往来，或排比句式（如方位、职能描述）。
- **操作**: 使用 Markdown 无序列表 (`- `) 进行格式化。
- **编号规则**: **不引入新的编号**。
- **示例 (对话)**:
  ```markdown
  [13]

  - 尧曰：“...”
  - 岳曰：“...”
  ```
- **示例 (方位)**:
  ```markdown
  [2]

  - 东至于...
  - 西至于...
  ```
- **原则**: 这种格式化仅为了视觉清晰，逻辑上它们仍属于同一个语义单元 `[N]`。
